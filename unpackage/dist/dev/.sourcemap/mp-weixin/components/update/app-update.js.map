{"version":3,"sources":["webpack:///E:/test/template/uni-app/components/update/app-update.vue?0cd1","webpack:///E:/test/template/uni-app/components/update/app-update.vue?0101","webpack:///E:/test/template/uni-app/components/update/app-update.vue?15b5","webpack:///E:/test/template/uni-app/components/update/app-update.vue?6502","uni-app:///components/update/app-update.vue","webpack:///E:/test/template/uni-app/components/update/app-update.vue?d488","webpack:///E:/test/template/uni-app/components/update/app-update.vue?e03d"],"names":[],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmI;AACnI;AAC8D;AACL;AACsC;;;AAG/F;AAC0M;AAC1M,gBAAgB,kNAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,iGAAM;AACR,EAAE,0GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACzBA;AAAA;AAAA;AAAA;AAA6xB,CAAgB,6yBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACkCjzB,6D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AADA,O,eAKA,EACA,iBADA,EAEA;AACA,WACA,UACA,aADA,EAEA,cAFA,CAEA;AAFA,KADA,EAKA,UACA,aADA,EAEA,cAFA,CAEA;AAFA,KALA,EAHA,EAaA,IAbA,kBAaA,CACA,SACA,iBADA,EACA;AACA,kBAFA,EAEA;AACA,sBAHA,EAGA;AACA,wBAJA,EAIA;AACA,oBALA,EAKA;AACA,mBANA,EAMA;AACA,qBACA,MADA,EACA;AACA,mBAFA,EAEA;AACA,gBAHA,CAGA;AAHA,OAPA,EAYA,WAZA,EAYA;AACA,iBAbA,EAaA;AACA,mBAdA,CAcA;AAdA,MAgBA,CA9BA,EA+BA,OA/BA,qBA+BA,CACA,UACA,gCACA,CAlCA,EAmCA,YACA;AACA,yCACA,4CACA,SACA,MACA,CAFA,MAEA,CACA,iBACA,CACA;AACA,sBADA,CACA;AADA;AAGA,KAZA;AAaA,aAbA,uBAaA;AACA;AACA;AACA;AACA;AACA;AACA,6BADA;AAEA,sBAFA;;AAIA,KAtBA,EAnCA;;AA2DA;AACA;AACA,UAFA,oBAEA;;;;;;;;;;;;;;;;;AAiBA,KAnBA;;AAqBA;AACA,iBAtBA,2BAsBA;AACA;AACA;AACA,UADA,CACA;AACA;AACA;AACA,iDADA;AAEA;AACA;AACA,SAFA,MAEA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAFA,MAEA;AACA,2BADA,CACA;AACA;AACA,OArBA;AAsBA,WAtBA,CAsBA;AACA;AACA;AACA,OAzBA;AA0BA,KAlDA;AAmDA;AACA,eApDA,yBAoDA;AACA,6EADA,CACA;AACA;AACA,6BADA,CACA;AACA;AACA;AACA;AACA;AACA,yBADA;AAEA,uBAFA;AAGA,0BAHA;AAIA,yBAJA;AAKA,6CALA;;AAOA,4BAVA,CAUA;AACA;AACA,OAdA,MAcA;AACA;AACA;AACA,KAvEA;;AAyEA;AACA,eA1EA,yBA0EA;AACA;AACA;AACA;AACA,2BADA;AAEA;AACA,cADA,CACA,eADA;AAEA,yBAFA;AAGA,uBAHA,CAGA,MAHA,CAFA;AAMA,OARA,MAQA;AACA,8BADA,CACA;AACA,0CAFA,CAEA;AACA;AACA,KAvFA;AAwFA;AACA,aAzFA,uBAyFA;AACA,mCADA,CACA;AACA,wBAFA,CAEA;;AAEA;AACA;AACA,0BAFA,CAEA;AACA,OAHA,MAGA;AACA;AACA,0BAFA,CAEA;AACA,OAHA,MAGA;AACA;AACA;AACA;AACA,SAHA;AAIA;AACA,KAzGA;AA0GA;AACA,gBA3GA,0BA2GA;AACA,6CADA,CACA;AACA;AACA,qBADA;;AAGA;AACA,wBADA;AAEA,aAFA;AAGA,6BAHA;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CADA,CACA;AACA;AACA;AACA;AACA,2CADA,CACA;AACA,oBATA;;AAWA,SAdA,MAcA;AACA;AACA;AACA;AACA;AACA;AACA,OArBA;AAsBA;AACA,KA7IA;;AA+IA;AACA,cAhJA,sBAgJA,IAhJA,EAgJA;AACA,6CADA,CACA;AACA;AACA,UADA,EACA,EADA;AAEA;AACA;AACA;AACA;AACA;AACA,SAFA;AAGA,OARA;;AAUA;AACA;AACA;AACA;AACA,OAdA;;AAgBA,KAlKA;AAmKA;AACA,kBApKA,0BAoKA,EApKA,EAoKA,EApKA,EAoKA;AACA;AACA;AACA;AACA;AACA,4BADA;AAEA,4BAFA;AAGA;AACA;AACA,yBADA;AAEA,mBAFA;AAGA,yBAHA;AAIA;AACA;AACA,SAFA,MAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAFA,MAEA;AACA;AACA;AACA,KA3LA,EA3DA,E;;;;;;;;;;;;;ACtCA;AAAA;AAAA;AAAA;AAAo/C,CAAgB,w8CAAG,EAAC,C;;;;;;;;;;;ACAxgD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/update/app-update.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./app-update.vue?vue&type=template&id=1af47460&scoped=true&\"\nvar renderjs\nimport script from \"./app-update.vue?vue&type=script&lang=js&\"\nexport * from \"./app-update.vue?vue&type=script&lang=js&\"\nimport style0 from \"./app-update.vue?vue&type=style&index=0&id=1af47460&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"1af47460\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/update/app-update.vue\"\nexport default component.exports","export * from \"-!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--16-0!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./app-update.vue?vue&type=template&id=1af47460&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 =\n    _vm.popup_show && !(_vm.downstatus < 1)\n      ? (_vm.downSize / 1024 / 1024).toFixed(2)\n      : null\n  var g1 =\n    _vm.popup_show && !(_vm.downstatus < 1)\n      ? (_vm.fileSize / 1024 / 1024).toFixed(2)\n      : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1\n      }\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./app-update.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--12-1!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./app-update.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"wrap\" v-if=\"popup_show\">\r\n\t\t<view class=\"popup-bg\" :style=\"getHeight\">\r\n\t\t\t<view class=\"popup-content\" :class=\"{ 'popup-content-show': popup_show }\">\r\n\t\t\t\t<view class=\"update-wrap\">\r\n\t\t\t\t\t<image src=\"./images/img.png\" class=\"top-img\"></image>\r\n\t\t\t\t\t<view class=\"content\">\r\n\t\t\t\t\t\t<text class=\"title\">发现新版本{{ update_info.version }}</text>\r\n\t\t\t\t\t\t<!-- 升级描述 -->\r\n\t\t\t\t\t\t<view class=\"title-sub\" v-html=\"update_info.info\"></view>\r\n\t\t\t\t\t\t<!-- 升级按钮 -->\r\n\t\t\t\t\t\t<button class=\"btn\" v-if=\"downstatus < 1\" @click=\"nowUpdate()\">\r\n\t\t\t\t\t\t\t立即升级\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<!-- 下载进度 -->\r\n\t\t\t\t\t\t<view class=\"sche-wrap\" v-else>\r\n\t\t\t\t\t\t\t<!-- 更新包下载中 -->\r\n\t\t\t\t\t\t\t<view class=\"sche-bg\">\r\n\t\t\t\t\t\t\t\t<view class=\"sche-bg-jindu\" :style=\"lengthWidth\"></view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t<text class=\"down-text\">下载进度:{{ (downSize / 1024 / 1024).toFixed(2) }}M/{{\r\n                  (fileSize / 1024 / 1024).toFixed(2)\r\n                }}M</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<image src=\"./images/close.png\" class=\"close-ioc\" @click=\"closeUpdate()\"></image>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tlet vm;\r\n\timport {\r\n\t\tgetUpdateInfo\r\n\t} from '@/api/public.js'\r\n\r\n\texport default {\r\n\t\tname: \"appUpdate\",\r\n\t\t//@是否强制更新\r\n\t\tprops: {\r\n\t\t\ttabbar: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false, //是否有原生tabbar组件\r\n\t\t\t},\r\n\t\t\tgetVer: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false, //是否有原生tabbar组件\r\n\t\t\t},\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpopup_show: false, //弹窗是否显示\r\n\t\t\t\tplatform: \"\", //ios or android\r\n\t\t\t\tversion: \"1.0.0\", //当前软件版本\r\n\t\t\t\tneed_update: false, // 是否更新\r\n\t\t\t\tdowning: false, //是否下载中\r\n\t\t\t\tdownstatus: 0, //0未下载  1已开始 2已连接到资源  3已接收到数据  4下载完成\r\n\t\t\t\tupdate_info: {\r\n\t\t\t\t\tos: \"\", //设备系统\r\n\t\t\t\t\tversion: \"\", //最新版本\r\n\t\t\t\t\tinfo: \"\", //升级说明\r\n\t\t\t\t},\r\n\t\t\t\tfileSize: 0, //文件大小\r\n\t\t\t\tdownSize: 0, //已下载大小\r\n\t\t\t\tviewObj: null, //原生遮罩view\r\n\t\t\t};\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tvm = this;\r\n\t\t\tif (!this.getVer) this.update()\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t// 下载进度计算\r\n\t\t\tlengthWidth: function() {\r\n\t\t\t\tlet w = (this.downSize / this.fileSize) * 100;\r\n\t\t\t\tif (!w) {\r\n\t\t\t\t\tw = 0;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tw = w.toFixed(2);\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\twidth: w + \"%\", //return 宽度半分比\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tgetHeight() {\r\n\t\t\t\tlet bottom = 0;\r\n\t\t\t\tif (this.tabbar) {\r\n\t\t\t\t\tbottom = 50;\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\tbottom: bottom + \"px\",\r\n\t\t\t\t\theight: \"auto\",\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 检查更新\r\n\t\t\tupdate() {\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\t// 获取手机系统信息\r\n\t\t\t\tuni.getSystemInfo({\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tvm.platform = res.platform; //ios  or android\r\n\t\t\t\t\t\tconsole.log(\"手机系统信息\", vm.platform);\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// 获取版本号\r\n\t\t\t\tplus.runtime.getProperty(plus.runtime.appid, function(inf) {\r\n\t\t\t\t\tvm.version = inf.version;\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(\"当前版本\", vm.version);\r\n\t\t\t\tthis.getUpdateInfo(); //获取更新信息\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\r\n\t\t\t// 获取线上版本信息\r\n\t\t\tgetUpdateInfo() {\r\n\t\t\t\t//向后台发起请求，获取最新版本号\r\n\t\t\t\tgetUpdateInfo(this.platform === \"ios\" ? 2 : 1)\r\n\t\t\t\t\t.then((res) => {\r\n\t\t\t\t\t\tconsole.log(res.data)\r\n\t\t\t\t\t\tconst tagDate = uni.getStorageSync('app_update_time') || '',\r\n\t\t\t\t\t\t\tnowDate = new Date().toLocaleDateString();\r\n\t\t\t\t\t\tif (tagDate !== nowDate && !this.getVer) {\r\n\t\t\t\t\t\t\tuni.setStorageSync('app_update_time', new Date().toLocaleDateString());\r\n\t\t\t\t\t\t} else if ((tagDate !== nowDate) && this.getVer) {\r\n\t\t\t\t\t\t\tif (!res.data.is_force) return\r\n\t\t\t\t\t\t} else if (tagDate == nowDate && !this.getVer && !res.data.is_force) {\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// 这里的返回的数据跟后台约定\r\n\t\t\t\t\t\tlet data = res.data;\r\n\t\t\t\t\t\t// 循环获取当前设备对应的更新数据\r\n\t\t\t\t\t\tvm.update_info = data;\r\n\t\t\t\t\t\tif (!vm.update_info.platform) {\r\n\t\t\t\t\t\t\t// 后台未配置当前系统的升级数据\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvm.checkUpdate(); ///检查是否更新\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch((err) => {\r\n\t\t\t\t\t\tvm.popup_show = false\r\n\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 检查是否更新\r\n\t\t\tcheckUpdate() {\r\n\t\t\t\tvm.need_update = vm.compareVersion(vm.version, vm.update_info.version); // 检查是否需要升级\r\n\t\t\t\tif (vm.need_update) {\r\n\t\t\t\t\tvm.popup_show = true; //线上版本号大于当前安装的版本号  显示升级框\r\n\t\t\t\t\tif (vm.tabbar) {\r\n\t\t\t\t\t\t//页面是否有原生tabbar组件\r\n\t\t\t\t\t\t// 创建原生view用来遮罩tabbar的点击事件 (如果是没有用原生的tabbar这一步可以取消)\r\n\t\t\t\t\t\tvm.viewObj = new plus.nativeObj.View(\"viewObj\", {\r\n\t\t\t\t\t\t\tbottom: \"0px\",\r\n\t\t\t\t\t\t\tleft: \"0px\",\r\n\t\t\t\t\t\t\theight: \"50px\",\r\n\t\t\t\t\t\t\twidth: \"100%\",\r\n\t\t\t\t\t\t\tbackgroundColor: \"rgba(0,0,0,.6)\",\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvm.viewObj.show(); //显示原生遮罩\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$emit('isNew')\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 取消更新\r\n\t\t\tcloseUpdate() {\r\n\t\t\t\tif (vm.update_info.is_force) {\r\n\t\t\t\t\t// 强制更新，取消退出app\r\n\t\t\t\t\tthis.platform == \"android\" ?\r\n\t\t\t\t\t\tplus.runtime.quit() :\r\n\t\t\t\t\t\tplus.ios\r\n\t\t\t\t\t\t.import(\"UIApplication\")\r\n\t\t\t\t\t\t.sharedApplication()\r\n\t\t\t\t\t\t.performSelector(\"exit\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvm.popup_show = false; //关闭升级弹窗\r\n\t\t\t\t\tif (vm.viewObj) vm.viewObj.hide(); //隐藏原生遮罩\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 立即更新\r\n\t\t\tnowUpdate() {\r\n\t\t\t\tif (vm.downing) return false; //如果正在下载就停止操作\r\n\t\t\t\tvm.downing = true; //状态改变 正在下载中\r\n\r\n\t\t\t\tif (/\\.apk$/.test(vm.update_info.url)) {\r\n\t\t\t\t\t// 如果是apk地址\r\n\t\t\t\t\tvm.download_wgt(); // 安装包/升级包更新\r\n\t\t\t\t} else if (/\\.wgt$/.test(vm.update_info.url)) {\r\n\t\t\t\t\t// 如果是更新包\r\n\t\t\t\t\tvm.download_wgt(); // 安装包/升级包更新\r\n\t\t\t\t} else {\r\n\t\t\t\t\tplus.runtime.openURL(vm.update_info.url, function() {\r\n\t\t\t\t\t\t//调用外部浏览器打开更新地址\r\n\t\t\t\t\t\tplus.nativeUI.toast(\"打开错误\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 下载升级资源包\r\n\t\t\tdownload_wgt() {\r\n\t\t\t\tplus.nativeUI.showWaiting(\"下载更新文件...\"); //下载更新文件...\r\n\t\t\t\tlet options = {\r\n\t\t\t\t\tmethod: \"get\",\r\n\t\t\t\t};\r\n\t\t\t\tlet dtask = plus.downloader.createDownload(\r\n\t\t\t\t\tvm.update_info.url,\r\n\t\t\t\t\toptions,\r\n\t\t\t\t\tfunction(d, status) {}\r\n\t\t\t\t);\r\n\r\n\t\t\t\tdtask.addEventListener(\"statechanged\", function(task, status) {\r\n\t\t\t\t\tif (status === null) {} else if (status == 200) {\r\n\t\t\t\t\t\t//在这里打印会不停的执行，请注意，正式上线切记不要在这里打印东西///////////////////////////////////////////////////\r\n\t\t\t\t\t\tvm.downstatus = task.state;\r\n\t\t\t\t\t\tswitch (task.state) {\r\n\t\t\t\t\t\t\tcase 3: // 已接收到数据\r\n\t\t\t\t\t\t\t\tvm.downSize = task.downloadedSize;\r\n\t\t\t\t\t\t\t\tif (task.totalSize) {\r\n\t\t\t\t\t\t\t\t\tvm.fileSize = task.totalSize; //服务器须返回正确的content-length才会有长度\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\tvm.installWgt(task.filename); // 安装wgt包\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tplus.nativeUI.closeWaiting();\r\n\t\t\t\t\t\tplus.nativeUI.toast(\"下载出错\");\r\n\t\t\t\t\t\tvm.downing = false;\r\n\t\t\t\t\t\tvm.downstatus = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tdtask.start();\r\n\t\t\t},\r\n\r\n\t\t\t// 安装文件\r\n\t\t\tinstallWgt(path) {\r\n\t\t\t\tplus.nativeUI.showWaiting(\"安装更新文件...\"); //安装更新文件...\r\n\t\t\t\tplus.runtime.install(\r\n\t\t\t\t\tpath, {},\r\n\t\t\t\t\tfunction() {\r\n\t\t\t\t\t\tplus.nativeUI.closeWaiting();\r\n\t\t\t\t\t\t// 应用资源下载完成！\r\n\t\t\t\t\t\tplus.nativeUI.alert(\"应用资源下载完成！\", function() {\r\n\t\t\t\t\t\t\tplus.runtime.restart();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t\tfunction(e) {\r\n\t\t\t\t\t\tplus.nativeUI.closeWaiting();\r\n\t\t\t\t\t\t// 安装更新文件失败\r\n\t\t\t\t\t\tplus.nativeUI.alert(\"安装更新文件失败[\" + e.code + \"]：\" + e.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t\t// 对比版本号\r\n\t\t\tcompareVersion(ov, nv) {\r\n\t\t\t\tif (!ov || !nv || ov == \"\" || nv == \"\") {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tlet b = false,\r\n\t\t\t\t\tova = ov.split(\".\", 4),\r\n\t\t\t\t\tnva = nv.split(\".\", 4);\r\n\t\t\t\tfor (let i = 0; i < ova.length && i < nva.length; i++) {\r\n\t\t\t\t\tlet so = ova[i],\r\n\t\t\t\t\t\tno = parseInt(so),\r\n\t\t\t\t\t\tsn = nva[i],\r\n\t\t\t\t\t\tnn = parseInt(sn);\r\n\t\t\t\t\tif (nn > no || sn.length > so.length) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else if (nn < no) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (nva.length > ova.length && 0 == nv.indexOf(ov)) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.popup-bg {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0rpx;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\twidth: 750rpx;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.6);\r\n\t\tz-index: 10000;\r\n\t}\r\n\r\n\t.popup-content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.popup-content-show {\r\n\t\tanimation: mymove 500ms;\r\n\t\ttransform: scale(1);\r\n\t}\r\n\r\n\t@keyframes mymove {\r\n\t\t0% {\r\n\t\t\ttransform: scale(0);\r\n\t\t\t/*开始为原始大小*/\r\n\t\t}\r\n\r\n\t\t100% {\r\n\t\t\ttransform: scale(1);\r\n\t\t}\r\n\t}\r\n\r\n\t.update-wrap {\r\n\t\twidth: 580rpx;\r\n\t\tborder-radius: 18rpx;\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tbackground-color: #ffffff;\r\n\t\tpadding: 170rpx 30rpx 0;\r\n\r\n\t\t.top-img {\r\n\t\t\tposition: absolute;\r\n\t\t\tleft: 0;\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 256rpx;\r\n\t\t\ttop: -128rpx;\r\n\t\t}\r\n\r\n\t\t.content {\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t\talign-items: center;\r\n\t\t\tpadding-bottom: 40rpx;\r\n\r\n\t\t\t.title {\r\n\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tcolor: #6526f3;\r\n\t\t\t}\r\n\r\n\t\t\t.title-sub {\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: #666666;\r\n\t\t\t\tpadding: 30rpx 0;\r\n\t\t\t}\r\n\r\n\t\t\t.btn {\r\n\t\t\t\twidth: 460rpx;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\tcolor: #ffffff;\r\n\t\t\t\tfont-size: 30rpx;\r\n\t\t\t\theight: 80rpx;\r\n\t\t\t\tline-height: 80rpx;\r\n\t\t\t\tborder-radius: 100px;\r\n\t\t\t\tbackground-color: #6526f3;\r\n\t\t\t\tmargin-top: 20rpx;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t.close-ioc {\r\n\t\twidth: 70rpx;\r\n\t\theight: 70rpx;\r\n\t\tmargin-top: 30rpx;\r\n\t}\r\n\r\n\t.sche-wrap {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: flex-end;\r\n\t\tpadding: 10rpx 50rpx 0;\r\n\r\n\t\t.sche-wrap-text {\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #666;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t}\r\n\r\n\t\t.sche-bg {\r\n\t\t\tposition: relative;\r\n\t\t\tbackground-color: #cccccc;\r\n\t\t\theight: 30rpx;\r\n\t\t\tborder-radius: 100px;\r\n\t\t\twidth: 480rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\r\n\t\t\t.sche-bg-jindu {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tleft: 0;\r\n\t\t\t\ttop: 0;\r\n\t\t\t\theight: 30rpx;\r\n\t\t\t\tmin-width: 40rpx;\r\n\t\t\t\tborder-radius: 100px;\r\n\t\t\t\tbackground: url(images/round.png) #5775e7 center right 4rpx no-repeat;\r\n\t\t\t\tbackground-size: 26rpx 26rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.down-text {\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #5674e5;\r\n\t\t\tmargin-top: 16rpx;\r\n\t\t}\r\n\t}\r\n</style>\r\n","import mod from \"-!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./app-update.vue?vue&type=style&index=0&id=1af47460&lang=scss&scoped=true&\"; export default mod; export * from \"-!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\anzhuang\\\\HBuilderX.3.3.13.20220314\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./app-update.vue?vue&type=style&index=0&id=1af47460&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1649240598435\n      var cssReload = require(\"D:/anzhuang/HBuilderX.3.3.13.20220314/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}